GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 4090') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
  | Name            | Type           | Params
---------------------------------------------------
0 | history_encoder | HistoryEncoder | 345 K
1 | backbone        | PN2HisDiT      | 3.3 M
---------------------------------------------------
3.7 M     Trainable params
0         Non-trainable params
3.7 M     Total params
14.682    Total estimated model params size (MB)
/home/yishu/miniconda3/envs/flowbothd/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:432: PossibleUserWarning: The dataloader, val_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 64 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
Sanity Checking DataLoader 0:   0%|                                         | 0/2 [00:00<?, ?it/s]
/home/yishu/miniconda3/envs/flowbothd/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py:212: UserWarning: You called `self.log('val_wta/multimodal', ...)` in your `validation_step` but the value needs to be floating point. Converting it to torch.float32.


Sanity Checking DataLoader 1:   0%|                                         | 0/2 [00:00<?, ?it/s]
/home/yishu/miniconda3/envs/flowbothd/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/logger_connector/result.py:212: UserWarning: You called `self.log('unseen_wta/multimodal', ...)` in your `validation_step` but the value needs to be floating point. Converting it to torch.float32.

Sanity Checking DataLoader 1:  50%|████████████████▌                | 1/2 [00:02<00:02,  2.30s/it]
/home/yishu/miniconda3/envs/flowbothd/lib/python3.9/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:432: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 64 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
/home/yishu/miniconda3/envs/flowbothd/lib/python3.9/site-packages/lightning/pytorch/loops/fit_loop.py:280: PossibleUserWarning: The number of training batches (43) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.




































Epoch 4: 100%|████████████████████████████████████████| 43/43 [00:14<00:00,  3.05it/s, v_num=knsq]















































Epoch 9: 100%|████████████████████████████████████████| 43/43 [00:14<00:00,  3.05it/s, v_num=knsq]














































Epoch 14: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.05it/s, v_num=knsq]














































Epoch 19: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.05it/s, v_num=knsq]














































Epoch 24: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.05it/s, v_num=knsq]














































Epoch 29: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.05it/s, v_num=knsq]














































Epoch 34: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.00it/s, v_num=knsq]














































Epoch 39: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.04it/s, v_num=knsq]














































Epoch 44: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.05it/s, v_num=knsq]














































Epoch 49: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.05it/s, v_num=knsq]















































Epoch 54: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.04it/s, v_num=knsq]















































Epoch 59: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.05it/s, v_num=knsq]















































Epoch 64: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.06it/s, v_num=knsq]














































Epoch 69: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.06it/s, v_num=knsq]














































Epoch 74: 100%|███████████████████████████████████████| 43/43 [00:14<00:00,  3.04it/s, v_num=knsq]



Validation DataLoader 0:  50%|███████████████████                   | 3/6 [00:06<00:06,  2.26s/it]
/home/yishu/miniconda3/envs/flowbothd/lib/python3.9/site-packages/lightning/pytorch/trainer/call.py:52: UserWarning:
Detected KeyboardInterrupt, attempting graceful shutdown...